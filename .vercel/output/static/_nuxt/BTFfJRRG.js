import{_ as Lt}from"./C2MT19gt.js";import{I as yt,R as zt,S as We,r as v,k as Fe,y as Ee,U as we,V as De,W as Ut,X as ut,Y as Vt,Z as Yt,$ as Ht,a0 as Bt,g as vt,c as f,o as c,l as T,E as g,m as Je,t as d,H as Ke,j as ce,a1 as Gt,M as bt,O as ue,B as re,a as t,b as C,w as Ce,v as Jt,n as se,T as qe,F as Le,q as ze,a2 as Wt,d as ne,J as Ue,s as F,L as Y,K as Ae,a3 as ct,D as Ve,_ as Kt}from"./Bd31R1Od.js";import{u as Qt}from"./Clk5V5eK.js";import{c as ae,u as Xt,S as Zt,C as es,U as mt,T as pt,L as ts,a as Ye}from"./CMdjsLor.js";import{u as ss,a as as,b as ls}from"./C--lilIF.js";/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=ae("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=ae("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=ae("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=ae("circle-help",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ae("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=ae("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=ae("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=ae("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ae("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=ae("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ae("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ps(){const m=yt(),{socialLogin:j,socialSignup:G,setAuthCredentials:E,socialAuthLoading:N,socialAuthError:_,logout:p}=zt(),{createUser:A}=We(),y=v(null),V=v(null),$=v(!1),J=v(!1),fe=async()=>{try{$.value=!0;const{$auth:x}=De();if(!x){console.error("Firebase Auth is not initialized"),V.value="Firebase Auth is not initialized",J.value=!0,$.value=!1;return}return Ut(x,o=>{y.value=o,J.value=!0,$.value=!1},o=>{console.error("Auth state change error:",o),V.value="Authentication state error",J.value=!0,$.value=!1})}catch(x){console.error("Error initializing auth state:",x),V.value="Failed to initialize authentication",J.value=!0,$.value=!1}};Fe(async()=>{await Ee(),await fe()});const ge=x=>{if(!x)return{firstName:"",lastName:""};const a=x.split(" "),o=a[0]||"",O=a.slice(1).join(" ");return{firstName:o,lastName:O}},ye=()=>{const x="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+";let a="";for(let o=0;o<12;o++)a+=x.charAt(Math.floor(Math.random()*x.length));return a},ie=async(x,a)=>{try{const{$auth:o}=De();if(!o)throw new Error("Firebase Auth is not initialized");$.value=!0,V.value=null,y.value&&await ut(o);const P=(await Bt(o,x)).user,z=await P.getIdToken(),{firstName:R,lastName:le}=ge(P==null?void 0:P.displayName),h=ye(),U={idToken:z,provider:a,email:P.email||"",uid:P.uid,displayName:P.displayName||"",photoURL:P.photoURL||"",firstName:R,lastName:le,password:h};E(U);const W=await j();if(console.log(W,"logon result"),W.success)return await A(W.data),W;const H=await G();if(console.log(H,"logon result"),H.success)return await A(H.data),H;throw new Error(H.message||"Social authentication failed")}catch(o){console.error("Social auth error:",o),V.value=o.message||"Authentication failed"}finally{$.value=!1}},oe=async()=>{const x=new Ht;return x.addScope("email"),x.addScope("profile"),x.setCustomParameters({prompt:"consent"}),await ie(x,"google")},Z=async()=>{const x=new Yt;x.addScope("email"),x.addScope("public_profile"),await ie(x,"facebook")},ee=async()=>{const x=new Vt("apple.com");x.addScope("email"),x.addScope("name"),await ie(x,"apple")},Pe=async()=>{try{const{$auth:x}=De();if(!x)throw new Error("Firebase Auth is not initialized");$.value=!0,await p(),await ut(x),m.push("/login")}catch(x){V.value=x.message}finally{$.value=!1}};return{user:we(y),error:we(V),loading:we($),initialized:we(J),socialAuthLoading:we(N),socialAuthError:we(_),signInWithGoogle:oe,signInWithFacebook:Z,signInWithApple:ee,logout:Pe}}const fs={class:"space-y-3"},gs=["disabled"],ys={key:0},vs={key:1},bs=["disabled"],xs={key:0},hs={key:1},ws={key:2,class:"text-red-600 text-sm text-center"},_s=vt({__name:"SocialLoginButtons",props:{authType:{type:String}},emits:["callback"],setup(m,{emit:j}){const{showToast:G}=Ke(),{signInWithGoogle:E,loading:N,error:_,socialAuthLoading:p,socialAuthError:A}=ps(),y=j,V=async()=>{try{const $=await E();y("callback",$)}catch($){G({title:"Error",message:$,toastType:`${$} || Google login failed`,duration:3e3})}};return($,J)=>(c(),f("div",fs,[m.authType==="login"?(c(),f("button",{key:0,onClick:V,disabled:g(N)||g(p),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-full shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[J[0]||(J[0]=Je('<svg class="w-5 h-5 mr-2" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg>',1)),!g(N)&&!g(p)?(c(),f("span",ys,"Sign in with Google")):(c(),f("span",vs,"Signing in..."))],8,gs)):T("",!0),m.authType==="signup"?(c(),f("button",{key:1,onClick:V,disabled:g(N)||g(p),class:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 rounded-full shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[J[1]||(J[1]=Je('<svg class="w-5 h-5 mr-2" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg>',1)),!g(N)&&!g(p)?(c(),f("span",xs,"Sign up with Google")):(c(),f("span",hs,"Signing up..."))],8,bs)):T("",!0),g(_)||g(A)?(c(),f("div",ws,d(g(_)||g(A)),1)):T("",!0)]))}}),{showToast:gt}=Ke(),Be={email:v(""),password:v("")},Cs=()=>{yt();const m=v(!1),j=ce(()=>m.value||!Be.email.value||!Be.password.value);return{credential:Be,login:async E=>{var _;m.value=!0;const N=await Gt.$_login({email:E.email,password:E.password});return console.log(N,"rse hee"),N.status===200||N.status===201?(We().createUser(N.data),gt({title:"Success",message:"Login was successfully",toastType:"success",duration:3e3})):gt({title:"Error",message:((_=N==null?void 0:N.data)==null?void 0:_.error)||"Something went wrong",toastType:"error",duration:3e3}),N},loading:m,isFormDisabled:j}};function Ps(){bt();const{createOrder:m,loading:j}=ss(),{handlePayment:G,paymentForm:E,loading:N,generateTxRef:_}=as(),p=v(null),A=v(""),y=v(""),V=v(!1),$=ce(()=>j.value||N.value),J=a=>a.map(o=>{let O=o.productId;return!O&&o.id&&(O=o.id.includes("-")?o.id.split("-")[0]:o.id),{product:O,quantity:o.quantity,price:o.price,size:o.size||"",color:o.color||"",discount:o.discount||0,total:o.price*o.quantity}}),fe=a=>({firstName:a.firstName,lastName:a.lastName,address:a.address,city:a.city,state:a.state,country:a.country,postalCode:a.zipCode||a.postalCode,phone:a.phone,email:a.email}),ge=a=>({isInstallment:!0,numberOfInstallments:parseInt(a.numberOfInstallments),downPayment:parseFloat(a.downPayment),installmentAmount:parseFloat(a.installmentAmount||0),interestRate:parseFloat(a.interestRate||0),totalPayable:parseFloat(a.totalPayable||0),paymentFrequency:a.paymentFrequency,paymentMethod:a.paymentMethod}),ye=a=>(a==null?void 0:a.taxRate)||2.5,ie=async a=>{var o,O,P,z,R,le;try{y.value="",A.value="",V.value=!1,console.log("Processing checkout with data:",a);const h=J(a.items),U=fe(a.deliveryDetails),W=U,H=ye(a.country),r={items:h,subtotal:parseFloat(a.subtotal.toFixed(2)),tax:parseFloat(a.tax.toFixed(2)),taxRate:H,shipping:parseFloat(a.shipping.toFixed(2)),discount:0,total:parseFloat(a.total.toFixed(2)),status:"pending",paymentStatus:"pending",paymentType:a.paymentType,shippingAddress:U,billingAddress:W,paymentMethod:a.paymentMethod,paidAmount:0,refundedAmount:0,shippingMethod:a.deliveryMethod,shippingCost:parseFloat(a.shipping.toFixed(2)),shippingCarrier:a.deliveryMethod==="express"?"Express Courier":"Standard Shipping",currency:"USD",source:"web",locale:"en-US",notes:`Delivery Method: ${a.deliveryMethod}, Payment Method: ${a.paymentMethod}${a.paymentType==="installment"?", Payment Type: Installment Plan":""}`,metadata:{country:a.country,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),checkoutVersion:"2.0",paymentType:a.paymentType,deliveryMethod:a.deliveryMethod,cartItemsCount:a.items.length,hasInstallmentItems:a.items.some(pe=>pe.hasInstallmentOption)}};a.paymentType==="installment"&&a.installmentConfig?(r.installmentInfo=ge(a.installmentConfig),r.paidAmount=parseFloat(a.installmentConfig.downPayment),r.paymentStatus="partially_paid",r.metadata={...r.metadata,installmentDetails:{startDate:a.installmentConfig.startDate,needsFormalAgreement:a.installmentConfig.needsFormalAgreement||!1,productSize:a.installmentConfig.productSize||((o=h[0])==null?void 0:o.size),originalInterestRate:a.installmentConfig.interestRate,paymentFrequency:a.installmentConfig.paymentFrequency,calculatedAt:new Date().toISOString(),downPaymentPercentage:parseFloat(a.installmentConfig.downPayment)/parseFloat(a.total.toFixed(2))*100}},r.notes+=`, Installment Terms: ${r.installmentInfo.numberOfInstallments} payments of $${(O=r.installmentInfo.installmentAmount)==null?void 0:O.toFixed(2)}`):r.installmentInfo={isInstallment:!1};const i=new Date;a.deliveryMethod==="express"?i.setDate(i.getDate()+3):i.setDate(i.getDate()+7),r.estimatedDelivery=i,console.log("Sending order payload to backend:",r);const I=await m(r);if(console.log(I.data._id,"res here"),!I||!((P=I==null?void 0:I.data)!=null&&P._id))return y.value="Failed to create order",{success:!1,error:((z=I==null?void 0:I.data)==null?void 0:z.message)||"Failed to create order"};console.log("Order created successfully:",I),p.value=I;let D=I.total;a.paymentType==="installment"&&a.installmentConfig&&(D=parseFloat(a.installmentConfig.downPayment)||a.immediatePayment||0,console.log("Installment payment - charging down payment:",D));const w=await oe(I,D,a.paymentType);return{success:!0,order:I,paymentAmount:D,paymentType:a.paymentType,paymentResult:w}}catch(h){console.error("Checkout process failed:",h);const U=((le=(R=h==null?void 0:h.response)==null?void 0:R.data)==null?void 0:le.message)||(h==null?void 0:h.message)||"Checkout process failed";return y.value=U,{success:!1,error:U}}},oe=async(a,o,O)=>{var P,z,R,le,h,U,W,H,r,i,I,D,w,pe,b;console.log(a,"order object before payment processing");try{console.log("Processing payment for order:",a.data._id,"Amount:",o),E.value.amount=o;const k=_();E.value.tx_ref=k,E.value.meta={orderId:(P=a==null?void 0:a.data)==null?void 0:P._id,orderNumber:(z=a==null?void 0:a.data)==null?void 0:z.orderNumber,paymentType:O,...O==="installment"&&{isDownPayment:!0,installmentPlan:(R=a==null?void 0:a.data)==null?void 0:R.installmentInfo,remainingAmount:((le=a==null?void 0:a.data)==null?void 0:le.total)-o}},E.value.customer={email:((U=(h=a==null?void 0:a.data)==null?void 0:h.shippingAddress)==null?void 0:U.email)||"",phone_number:((H=(W=a==null?void 0:a.data)==null?void 0:W.shippingAddress)==null?void 0:H.phone)||"",name:`${((i=(r=a==null?void 0:a.data)==null?void 0:r.shippingAddress)==null?void 0:i.firstName)||""} ${((D=(I=a==null?void 0:a.data)==null?void 0:I.shippingAddress)==null?void 0:D.lastName)||""}`.trim()},E.value.title=`Order ${(w=a==null?void 0:a.data)==null?void 0:w.orderNumber}`,E.value.description=O==="installment"?`Down payment for installment order ${(pe=a==null?void 0:a.data)==null?void 0:pe.orderNumber}`:`Payment for order ${(b=a==null?void 0:a.data)==null?void 0:b.orderNumber}`,console.log("Payment form configured:",E.value);const K=await G(a==null?void 0:a.data);return console.log(K,"Final payment result"),{success:!0,paymentReference:k,amount:o,paymentResult:K}}catch(k){return console.error("Payment processing failed:",k),A.value=k.message||"Payment processing failed",{success:!1,error:k.message||"Payment processing failed"}}};return{processCheckout:ie,verifyPayment:async(a,o)=>{var O,P,z;try{return!a&&!o?{success:!1,error:"No payment reference provided"}:(console.log("Verifying payment:",{flw_ref:a,tx_ref:o}),V.value=!0,{success:!0,flw_ref:a,tx_ref:o,orderId:((O=p.value)==null?void 0:O._id)||"",orderNumber:((P=p.value)==null?void 0:P.orderNumber)||"",paymentType:((z=p.value)==null?void 0:z.paymentType)||"full"})}catch(R){return console.error("Payment verification failed:",R),{success:!1,error:R.message||"Payment verification failed"}}},createInstallmentPlan:async(a,o)=>{try{return console.log("Creating installment plan for order:",a,o),{success:!0,installmentPlanId:`plan-${a}-${Date.now()}`,message:"Installment plan created successfully"}}catch(O){return console.error("Failed to create installment plan:",O),{success:!1,error:O.message||"Failed to create installment plan"}}},resetCheckout:()=>{p.value=null,A.value="",y.value="",V.value=!1},orderResponse:p,getPaymentSummary:()=>{var o;if(!p.value)return null;const a=p.value;return{orderNumber:a.orderNumber,total:a.total,paymentType:a.paymentType,installmentInfo:a.installmentInfo,items:a.items,paidAmount:a.paymentType==="installment"?((o=a.installmentInfo)==null?void 0:o.downPayment)||0:a.total}},isLoading:$,orderLoading:j,paymentLoading:N,orderCreationError:y,paymentError:A,paymentComplete:V,paymentForm:E}}const me={$_create_shipping_config(m){return ue.post("/shipping-tax/shipping",m)},$_create_tax_config(m){return ue.post("/shipping-tax/tax",m)},$_get_all_shipping_configs(){return ue.get("/shipping-tax/shipping")},$_get_all_tax_configs(){return ue.get("/shipping-tax/tax")},$_update_shipping_config(m,j){return ue.patch(`/shipping-tax/shipping/${m}`,j)},$_update_tax_config(m,j){return ue.patch(`/shipping-tax/tax/${m}`,j)},$_delete_shipping_config(m){return ue.delete(`/shipping-tax/shipping/${m}`)},$_delete_tax_config(m){return ue.delete(`/shipping-tax/tax/${m}`)}},Is=()=>{const m=v(null),j=async()=>{try{return(await me.$_get_all_tax_configs()).data}catch(_){throw m.value=_.message||"Failed to fetch tax configs",m.value}},G=async _=>{try{return(await me.$_create_tax_config({..._})).data}catch(p){throw m.value=p.message||"Failed to create tax config",m.value}},E=async(_,p)=>{try{return(await me.$_update_tax_config(_,{countryCode:p.countryCode||"",countryName:p.countryName||"",vatRate:p.vatRate||0,isActive:p.isActive!==void 0?p.isActive:!0})).data}catch(A){throw m.value=A.message||"Failed to update tax config",m.value}},N=async _=>{try{return(await me.$_delete_tax_config(_)).data}catch(p){throw m.value=p.message||"Failed to delete tax config",m.value}};return Fe(()=>{j()}),{error:m,fetchTaxConfigs:j,createTaxConfig:G,updateTaxConfig:E,deleteTaxConfig:N}},ks=()=>{const m=v(null),j=async()=>{try{return(await me.$_get_all_shipping_configs()).data}catch(_){throw m.value=_.message||"Failed to fetch shipping configs",m.value}},G=async _=>{try{return(await me.$_create_shipping_config({..._})).data}catch(p){throw m.value=p.message||"Failed to create shipping config",m.value}},E=async(_,p)=>{try{return(await me.$_update_shipping_config(_,{countryCode:p.countryCode||"",countryName:p.countryName||"",shippingRate:p.shippingRate||0,isActive:p.isActive!==void 0?p.isActive:!0})).data}catch(A){throw m.value=A.message||"Failed to update shipping config",m.value}},N=async _=>{try{return(await me.$_delete_shipping_config(_)).data}catch(p){throw m.value=p.message||"Failed to delete shipping config",m.value}};return Fe(()=>{j()}),{error:m,fetchShippingConfigs:j,createShippingConfig:G,updateShippingConfig:E,deleteShippingConfig:N}},Ss={class:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100"},Ts={key:0,class:"container mx-auto px-4 py-16 min-h-screen flex items-center justify-center"},As={class:"max-w-md mx-auto bg-white rounded-2xl shadow-xl p-8 border border-slate-200 text-center"},Ns={class:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center"},Ms={key:1,class:"container mx-auto px-4 py-16 min-h-screen flex items-center justify-center"},Es={class:"max-w-lg mx-auto bg-white rounded-2xl shadow-xl p-8 border border-slate-200"},Fs={class:"text-center mb-8"},$s={class:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-full flex items-center justify-center"},Os={class:"bg-slate-50 rounded-xl p-6 mb-8"},js={class:"flex justify-between items-center mb-3"},Rs={class:"font-bold text-slate-800"},Ds={class:"flex justify-between items-center mb-3"},qs={class:"font-bold text-slate-800"},Ls={key:0,class:"flex justify-between items-center mb-3"},zs={class:"font-bold text-emerald-600"},Us={class:"flex justify-between items-center"},Vs={class:"text-slate-600 font-medium"},Ys={class:"font-bold text-xl text-slate-800"},Hs={key:2,class:"container mx-auto px-4 py-8 lg:py-12"},Bs={class:"max-w-2xl mx-auto mb-12"},Gs={class:"flex items-center justify-between relative"},Js={class:"absolute top-4 left-0 right-0 h-0.5 bg-slate-200"},Ws={class:"relative flex flex-col items-center"},Ks={class:"relative flex flex-col items-center"},Qs={class:"relative flex flex-col items-center"},Xs={class:"lg:grid space-y-6 lg:space-y-0 grid-cols-5 gap-8 lg:max-w-7xl mx-auto"},Zs={class:"lg:col-span-3"},ea={key:0,class:"bg-white rounded-2xl shadow-lg border border-slate-200 p-4 lg:p-8"},ta={class:"flex items-center mb-6"},sa={class:"w-10 h-10 bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mr-4"},aa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},la={class:"space-y-2"},na={class:"space-y-2"},oa={class:"space-y-2"},ra={class:"space-y-2"},ia={class:"space-y-2"},da={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ua={class:"space-y-2"},ca={class:"space-y-2"},ma={class:"space-y-2"},pa={class:"space-y-2"},fa=["value"],ga={type:"submit",class:"w-full py-4 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-medium flex items-center justify-center"},ya={key:1,class:"bg-white rounded-2xl shadow-lg border border-slate-200 p-4 lg:p-8"},va={class:"flex items-center mb-6"},ba={class:"w-10 h-10 bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mr-4"},xa={class:"space-y-4 mb-8"},ha={class:"flex items-center"},wa={key:0,class:"w-3 h-3 rounded-full bg-white"},_a={class:"flex-1"},Ca={class:"flex justify-between items-center mb-1"},Pa={class:"font-bold text-slate-800"},Ia={class:"flex gap-2"},ka={key:2,class:"bg-white rounded-2xl shadow-lg border border-slate-200 p-4 lg:p-8"},Sa={class:"flex items-center mb-6"},Ta={class:"w-10 h-10 bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mr-4"},Aa={class:"mb-8"},Na={class:"space-y-4"},Ma={class:"flex items-center"},Ea={key:0,class:"w-3 h-3 rounded-full bg-white"},Fa={class:"flex-1"},$a={class:"flex justify-between items-center mb-1"},Oa={class:"font-bold text-emerald-600"},ja={class:"w-10 h-10 bg-emerald-100 rounded-md flex items-center justify-center ml-4"},Ra={class:"flex items-center"},Da={key:0,class:"w-3 h-3 rounded-full bg-white"},qa={class:"flex-1"},La={class:"flex justify-between items-center mb-1"},za={class:"font-bold text-blue-600"},Ua={class:"w-10 h-10 bg-blue-100 rounded-md flex items-center justify-center ml-4"},Va={key:1,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},Ya={class:"flex items-center"},Ha={class:"mt-2 text-xs text-yellow-700"},Ba={key:0,class:"mb-8 p-6 bg-blue-50 rounded-xl border border-blue-200"},Ga={class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},Ja={class:"space-y-6"},Wa={class:"bg-white p-4 rounded-lg border border-blue-200"},Ka={class:"flex justify-between items-center mb-2"},Qa={class:"text-lg font-bold text-slate-800"},Xa={class:"space-y-3"},Za=["value"],el={class:"space-y-3"},tl={class:"space-y-3"},sl={class:"block text-sm font-semibold text-slate-700"},al={class:"relative"},ll=["min","max"],nl={class:"flex justify-between text-xs text-slate-500"},ol={class:"space-y-3"},rl=["min"],il={class:"space-y-3"},dl={class:"space-y-3"},ul={class:"space-y-2"},cl={class:"flex items-center"},ml={class:"flex items-center"},pl={key:0,class:"bg-white p-6 rounded-lg border border-blue-200"},fl={class:"space-y-3"},gl={class:"flex justify-between"},yl={class:"font-semibold"},vl={class:"flex justify-between"},bl={class:"font-semibold"},xl={class:"flex justify-between"},hl={class:"font-semibold"},wl={class:"flex justify-between"},_l={class:"font-semibold"},Cl={class:"flex justify-between"},Pl={class:"font-semibold"},Il={class:"border-t pt-3"},kl={class:"flex justify-between"},Sl={class:"font-bold text-lg"},Tl={class:"mb-8"},Al={class:"space-y-4"},Nl={class:"flex items-center"},Ml={key:0,class:"w-3 h-3 rounded-full bg-white"},El={class:"w-10 h-10 bg-slate-100 rounded-md flex items-center justify-center"},Fl={class:"lg:flex space-y-6 lg:space-y-0 gap-4"},$l=["disabled"],Ol={class:"lg:col-span-2"},jl={class:"bg-white rounded-2xl shadow-lg border border-slate-200 p-4 lg:p-6 sticky top-6"},Rl={class:"flex items-center mb-6"},Dl={class:"w-10 h-10 bg-gradient-to-br from-slate-100 to-slate-200 rounded-xl flex items-center justify-center mr-4"},ql={key:0,class:"space-y-4 mb-6 max-h-80 overflow-y-auto pr-2 custom-scrollbar"},Ll={class:"w-16 h-16 bg-slate-100 rounded-lg overflow-hidden flex-shrink-0"},zl=["src","alt"],Ul={class:"flex-1 min-w-0"},Vl={class:"font-semibold text-slate-800 text-sm truncate"},Yl={class:"text-sm text-slate-600"},Hl={class:"flex items-center gap-2 mt-1"},Bl={key:0,class:"text-xs px-2 py-1 bg-slate-100 rounded-full text-slate-600"},Gl={key:1,class:"text-xs px-2 py-1 bg-slate-100 rounded-full text-slate-600"},Jl={key:2,class:"text-xs px-2 py-1 bg-emerald-100 text-emerald-700 rounded-full"},Wl={class:"flex items-center mt-2"},Kl=["onClick","disabled"],Ql={class:"mx-3 text-sm font-semibold min-w-[2rem] text-center"},Xl=["onClick"],Zl=["onClick"],en={class:"text-right"},tn={class:"font-semibold text-slate-800"},sn={class:"border-t border-slate-200 pt-4 space-y-3"},an={class:"flex justify-between text-sm"},ln={class:"font-semibold text-slate-800"},nn={class:"flex justify-between text-sm"},on={class:"font-semibold text-slate-800"},rn={class:"flex justify-between text-sm"},dn={class:"text-slate-600"},un={class:"font-semibold text-slate-800"},cn={key:0,class:"bg-blue-50 p-3 rounded-lg border border-blue-200"},mn={class:"flex justify-between text-xs text-blue-700 mb-1"},pn={class:"flex justify-between text-xs text-blue-700 mb-1"},fn={class:"flex justify-between text-xs text-blue-700"},gn={key:1,class:"text-xs text-slate-500 bg-slate-50 p-3 rounded-lg"},yn={key:0},vn={class:"flex justify-between font-bold text-lg pt-3 border-t border-slate-200"},bn={class:"text-slate-800"},xn={class:"text-slate-800"},hn={key:2,class:"bg-emerald-50 p-3 rounded-lg border border-emerald-200"},wn={class:"flex justify-between font-semibold text-emerald-800"},_n={class:"mt-6 pt-4 border-t border-slate-200"},Cn={class:"flex items-center text-sm text-slate-600 mb-3"},Pn={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 backdrop-blur-sm"},In={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative"},kn={key:0},Sn={class:"space-y-3"},Tn={key:1},An={class:"mb-4"},Nn={class:"space-y-2"},Mn={class:"space-y-2"},En=["disabled"],Fn={class:"text-center"},$n={key:2},On={class:"mb-4"},jn={class:"grid grid-cols-2 gap-4"},Rn={class:"space-y-2"},Dn={class:"space-y-2"},qn={class:"space-y-2"},Ln={class:"space-y-2"},zn={class:"space-y-2"},Un=["disabled"],Vn={class:"text-center"},Yn=2.5,Me=1,Ge=3,Hn=vt({__name:"checkout",setup(m,{expose:j}){const G=bt(),E=Wt(),{processCheckout:N,isLoading:_,paymentComplete:p}=Ps(),A=v(!1),{showToast:y}=Ke(),V=s=>{s.success&&(A.value=!1)},{cart:$,removeFromCart:J,updateCartItemQuantity:fe}=Qt(),{signup:ge}=Xt(),{login:ye}=Cs(),{isLoggedIn:ie,user:oe}=We(),{setItem:Z,getItem:ee,removeItem:Pe}=ls(),{fetchShippingConfigs:x}=ks(),{fetchTaxConfigs:a}=Is(),o=v([]),O=v([]),P=v(null),z=v(0),R=v(0),le=v(!1),h=v(1),U=v("check"),W=v(!1),H=v(!1),r=v([]),i=v({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",country:""}),I=v("standard"),D=v("flutterwave"),w=v("full"),pe=v(""),b=v({numberOfInstallments:"",paymentFrequency:"",downPayment:0,startDate:"",paymentMethod:"",needsFormalAgreement:!1,interestRate:0,totalAmount:0}),k=v({downPayment:0,installmentAmount:0,totalInterest:0,totalPayable:0,remainingAmount:0}),K=v(null),q=v({firstName:"",lastName:"",email:"",password:"",phone:"",role:"customer"}),ve=v({email:"",password:""}),L={CART:"art-gallery-cart",CHECKOUT_STEP:"checkout-step",DELIVERY_DETAILS:"checkout-delivery-details",DELIVERY_METHOD:"checkout-delivery-method",PAYMENT_METHOD:"checkout-payment-method",PAYMENT_TYPE:"checkout-payment-type",INSTALLMENT_CONFIG:"checkout-installment-config",SELECTED_COUNTRY:"checkout-selected-country",SHIPPING_CONFIG:"checkout-shipping-config",TAX_CONFIG:"checkout-tax-config",GUEST_MODE:"checkout-guest-mode"},Ie=ce(()=>{console.log("Checking installment options for cart items:",r.value);const s=r.value.some(e=>{var u;const n=e.hasInstallmentOption===!0&&e.installmentConfig&&e.installmentConfig.enabled===!0;return console.log(`Item ${e.id}: hasInstallmentOption=${e.hasInstallmentOption}, config enabled=${(u=e.installmentConfig)==null?void 0:u.enabled}, result=${n}`),n});return console.log("Overall hasInstallmentOptions:",s),s}),xt=ce(()=>r.value.filter(s=>s.hasInstallmentOption===!0&&s.installmentConfig&&s.installmentConfig.enabled===!0)),Qe=ce(()=>{const s=new Set;r.value.forEach(n=>{var u;if(n.hasInstallmentOption===!0&&((u=n.installmentConfig)==null?void 0:u.enabled)===!0){const l=n.installmentConfig;l.availableTerms&&Array.isArray(l.availableTerms)&&l.availableTerms.forEach(B=>s.add(B))}});const e=Array.from(s).sort((n,u)=>n-u);return console.log("Available installment terms:",e),e}),ht=()=>{if(!Ie.value)return 0;const s=te(),e=Math.max(...Qe.value);return s/e},wt=s=>{if(!K.value){const X=te(),M=X*.2;return(X-M)/s}const e=te(),n=K.value.minimumDownPaymentPercentage||20,u=e*n/100,l=e-u,B=(K.value.interestRate||0)/12/100;if(B>0){const X=Math.pow(1+B,s);return l*B*X/(X-1)}else return l/s},$e=()=>{const s=r.value.find(e=>e.hasInstallmentOption===!0&&e.installmentConfig&&e.installmentConfig.enabled===!0);return console.log("Current installment config from item:",s==null?void 0:s.installmentConfig),(s==null?void 0:s.installmentConfig)||null};re(r,()=>{K.value=$e(),console.log("Updated currentInstallmentConfig:",K.value)},{deep:!0});const Xe=()=>{var s;return((s=K.value)==null?void 0:s.minimumDownPaymentPercentage)||20},Ze=()=>{var s;return((s=K.value)==null?void 0:s.maximumDownPaymentPercentage)||80},_e=()=>te()*Xe()/100,ke=()=>te()*Ze()/100,et=()=>{var s;return((s=K.value)==null?void 0:s.interestRate)||0},_t=()=>new Date().toISOString().split("T")[0],be=()=>{if(console.log("Calculating installment details..."),console.log("Config:",b.value),!b.value.numberOfInstallments||!b.value.downPayment){console.log("Missing required fields for calculation"),k.value={downPayment:0,installmentAmount:0,totalInterest:0,totalPayable:0,remainingAmount:0};return}const s=te(),e=Number(b.value.downPayment),n=s-e,u=parseInt(b.value.numberOfInstallments),l=et(),B=l/12/100;console.log("Calculation inputs:",{totalAmount:s,downPayment:e,remainingAmount:n,numberOfInstallments:u,annualInterestRate:l,monthlyInterestRate:B});let X=0,M=0;if(B>0){const dt=Math.pow(1+B,u);X=n*B*dt/(dt-1),M=X*u-n}else X=n/u,M=0;const Re=e+X*u;console.log("Calculation results:",{installmentAmount:X,totalInterest:M,totalPayable:Re}),k.value={downPayment:e,installmentAmount:X,totalInterest:M,totalPayable:Re,remainingAmount:n},b.value.totalAmount=s,b.value.interestRate=l},Ct=ce(()=>{if(console.log("Checking payment config validity..."),console.log("Payment type:",w.value),console.log("Payment method:",D.value),w.value==="full"){const s=D.value!=="";return console.log("Full payment valid:",s),s}else if(w.value==="installment"){const s=b.value,e=D.value!==""&&s.numberOfInstallments!==""&&s.paymentFrequency!==""&&s.downPayment>0&&s.startDate!==""&&s.paymentMethod!==""&&s.downPayment>=_e()&&s.downPayment<=ke()&&typeof s.needsFormalAgreement=="boolean";return console.log("Installment payment validation:",{paymentMethod:D.value!=="",numberOfInstallments:s.numberOfInstallments!=="",paymentFrequency:s.paymentFrequency!=="",downPayment:s.downPayment>0,startDate:s.startDate!=="",installmentPaymentMethod:s.paymentMethod!=="",downPaymentRange:s.downPayment>=_e()&&s.downPayment<=ke(),formalAgreement:typeof s.needsFormalAgreement=="boolean",overall:e}),e}return!1}),Pt=()=>_.value?"Processing...":w.value==="installment"?`Pay Down Payment - $${S(k.value.downPayment)}`:`Complete Order - $${S(te())}`,tt=s=>{if(w.value=s,s==="installment"&&(K.value=$e(),K.value)){b.value.downPayment=_e();const e=new Date;e.setDate(e.getDate()+30),b.value.startDate=e.toISOString().split("T")[0],Ee(()=>{be()})}Q()},It=()=>{try{if(localStorage){const s=localStorage.getItem(L.CART);if(s){const e=JSON.parse(s);if(Array.isArray(e))return r.value=e,console.log("Loaded cart from storage:",e),e}}}catch(s){console.error("Failed to load cart from localStorage:",s)}return[]},xe=()=>{try{localStorage&&localStorage.setItem(L.CART,JSON.stringify(r.value))}catch(s){console.error("Failed to save cart to localStorage:",s)}},Q=()=>{try{localStorage&&(Z(L.CHECKOUT_STEP,h.value.toString()),Z(L.DELIVERY_METHOD,I.value),Z(L.PAYMENT_METHOD,D.value),Z(L.PAYMENT_TYPE,w.value),Z(L.INSTALLMENT_CONFIG,JSON.stringify(b.value)),Z(L.DELIVERY_DETAILS,JSON.stringify(i.value)),P.value&&Z(L.SELECTED_COUNTRY,JSON.stringify({countryInfo:P.value,shippingFee:z.value,taxRate:R.value})))}catch(s){console.error("Failed to persist checkout data:",s)}},de=()=>{Q()},kt=()=>{try{if(localStorage){const s=ee(L.CHECKOUT_STEP);if(s&&!isNaN(Number(s))){const M=Number(s);M>=Me&&M<=Ge&&(h.value=M)}const e=ee(L.DELIVERY_METHOD);e&&["standard","express","pickup"].includes(e)&&(I.value=e);const n=ee(L.PAYMENT_METHOD);n&&["flutterwave","interswitch","manual"].includes(n)&&(D.value=n);const u=ee(L.PAYMENT_TYPE);u&&["full","installment"].includes(u)&&(w.value=u);const l=ee(L.INSTALLMENT_CONFIG);if(l)try{const M=JSON.parse(l);Object.assign(b.value,M)}catch(M){console.error("Failed to parse saved installment config",M)}const B=ee(L.DELIVERY_DETAILS);if(B)try{const M=JSON.parse(B);Object.assign(i.value,M)}catch(M){console.error("Failed to parse saved delivery details",M)}const X=ee(L.SELECTED_COUNTRY);if(X)try{const M=JSON.parse(X);P.value=M.countryInfo,z.value=M.shippingFee||0,R.value=M.taxRate||0}catch(M){console.error("Failed to parse saved country data",M)}}}catch(s){console.error("Failed to load persisted checkout data:",s)}},st=()=>{try{localStorage&&Object.values(L).forEach(s=>{s!==L.CART&&Pe(s)})}catch(s){console.error("Failed to clear persisted checkout data:",s)}},Se=ce(()=>!r.value||r.value.length===0?0:r.value.reduce((s,e)=>{const n=e.price||0,u=e.quantity||0;return s+n*u},0)),St=ce(()=>{var s;return Array.isArray(o.value)&&((s=o==null?void 0:o.value)==null?void 0:s.filter(e=>e.isActive))}),Tt=async()=>{try{le.value=!0;const[s,e]=await Promise.all([x(),a()]);o.value=s||[],O.value=e||[],await Ee(),i.value.country&&o.value.length>0&&at()}catch(s){console.error("Failed to load configurations:",s);const e=he(s);y&&y({title:"Configuration Error",message:e||"Failed to load shipping and tax configurations. Please refresh the page or contact support.",toastType:"error",duration:5e3})}finally{le.value=!1}},at=()=>{const s=i.value.country;if(!s){P.value=null,z.value=0,R.value=0;return}const e=o.value.find(u=>u.countryCode===s&&u.isActive),n=O.value.find(u=>u.countryCode===s&&u.isActive);e?(P.value=e,z.value=e.shippingRate||0):(P.value=null,z.value=0),n?R.value=n.vatRate||0:R.value=0,Q()},At=s=>{I.value=s,Q()},Nt=s=>{D.value=s,Q()},Te=()=>I.value==="pickup"?0:I.value==="express"?z.value*Yn:z.value,Oe=()=>Se.value*R.value/100,te=()=>{const s=Se.value,e=Te(),n=Oe();return s+e+n},lt=()=>{const s={...E.query};h.value>Me?s.step=h.value.toString():delete s.step,G.replace({query:s})},nt=()=>{h.value<Ge&&(h.value++,Q(),lt())},ot=()=>{h.value>Me&&(h.value--,Q(),lt())},Mt=()=>{const s=E.query.step;if(s&&!isNaN(Number(s))){const e=Number(s);e>=Me&&e<=Ge&&(h.value=e)}},je=()=>{const s={...E.query};delete s.step,G.replace({query:s})},he=s=>{if(!s)return"An unknown error occurred";if(typeof s=="string")return s;if(s.response){const{data:e,statusText:n}=s.response;if(e){if(typeof e=="string")return e;if(e.message)return e.message;if(e.error)return typeof e.error=="string"?e.error:JSON.stringify(e.error);if(e.errors&&Array.isArray(e.errors))return e.errors.join(", ")}return n||`Error ${s.response.status}`}if(s.message)return s.message;if(s.error){if(typeof s.error=="string")return s.error;if(s.error.message)return s.error.message}try{return JSON.stringify(s)}catch{return"An unexpected error occurred"}},Et=async()=>{var s,e;console.log("process payment");try{if(!r.value||r.value.length===0){y({title:"Error",message:"Your cart is empty. Please add items before proceeding.",toastType:"error",duration:3e3});return}const n={paymentType:w.value,items:r.value.map(l=>({productId:l.productId,id:l.id,title:l.title,image:l.image,price:l.price,quantity:l.quantity,size:l.size,color:l.color,discount:l.discount||0,total:l.price*l.quantity,hasInstallmentOption:l.hasInstallmentOption,installmentConfig:l.installmentConfig,category:l.category,weight:l.weight,dimensions:l.dimensions})),subtotal:Se.value,shipping:Te(),tax:Oe(),total:te(),deliveryDetails:i.value,deliveryMethod:I.value,paymentMethod:D.value};console.log(n,"here payload"),w.value==="installment"&&(n.installmentConfig={...b.value,...k.value,productSize:(s=r.value[0])==null?void 0:s.size,product:(e=r.value[0])==null?void 0:e.productId},n.immediatePayment=k.value.downPayment),P.value&&(n.country={code:P.value.countryCode,name:P.value.countryName,taxRate:R.value}),console.log("Sending checkout data:",n);const u=await N(n);if(console.log(u,"processing result"),u.success)return pe.value=u.order.orderNumber,je(),y({title:"Order Created Successfully",message:`Order #${u.order.orderNumber} has been created. ${w.value==="installment"?"Down payment processed.":"Payment completed."}`,toastType:"success",duration:5e3}),u;throw new Error(u.error||"Checkout failed")}catch(n){console.error("Payment processing failed:",n);const u=he(n);throw y({title:"Payment Failed",message:u||"There was an error processing your payment. Please try again.",toastType:"error",duration:5e3}),n}},Ft=()=>{A.value=!1,Z&&Z(L.GUEST_MODE,"true")},$t=()=>{A.value=!1,U.value="check"},Ot=async()=>{try{W.value=!0;const s={firstName:q.value.firstName,lastName:q.value.lastName,email:q.value.email,password:q.value.password,phone:q.value.phone,role:q.value.role};if(ge){const e=await ge(s);if(e&&e.success)i.value&&(i.value.firstName=q.value.firstName,i.value.lastName=q.value.lastName,i.value.email=q.value.email,i.value.phone=q.value.phone||""),Q(),y&&y({title:e.title||"Account Created",message:e.message||"Your account has been created successfully!",toastType:"success",duration:3e3}),A.value=!1;else{e&&!e.success&&y&&y({title:e.title||"Signup Failed",message:e.message||"There was an error creating your account. Please try again.",toastType:"error",duration:5e3});return}}}catch(s){console.error("Signup failed:",s);const e=he(s);y&&y({title:"Signup Failed",message:e||"There was an error creating your account. Please try again.",toastType:"error",duration:5e3})}finally{W.value=!1}},jt=async()=>{try{H.value=!0;const s={email:ve.value.email,password:ve.value.password};if(ye){const e=await ye(s);if(e&&e.success){try{const n=JSON.parse(localStorage.getItem("user-data")||"{}");n&&i.value&&(i.value.firstName=n.firstName||"",i.value.lastName=n.lastName||"",i.value.email=n.email||"",i.value.phone=n.phone||"",Q())}catch(n){console.warn("Failed to parse user data from localStorage:",n)}y&&y({title:e.title||"Signed In",message:e.message||"You have been signed in successfully!",toastType:"success",duration:3e3}),A.value=!1}else{e&&!e.success&&y&&y({title:e.title||"Sign In Failed",message:e.message||"There was an error signing in. Please check your credentials and try again.",toastType:"error",duration:5e3});return}}}catch(s){console.error("Signin failed:",s);const e=he(s);y&&y({title:"Sign In Failed",message:e||"There was an error signing in. Please check your credentials and try again.",toastType:"error",duration:5e3})}finally{H.value=!1}},S=s=>typeof s!="number"||isNaN(s)?"0.00":s.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),Rt=()=>Math.floor(Math.random()*9e5+1e5).toString(),rt=async(s,e)=>{if(typeof s=="string"&&typeof e=="number"&&e>0)try{if(fe){const n=await fe(s,e);if(n&&n.success){const u=r.value.findIndex(l=>l.id===s);u!==-1&&(r.value[u].quantity=e,xe()),y&&y({title:n.title||"Cart Updated",message:n.message||"Item quantity has been updated",toastType:"info",duration:2e3})}else n&&!n.success&&y&&y({title:n.title||"Update Failed",message:n.message||"Failed to update item quantity. Please try again.",toastType:"error",duration:3e3})}else{const n=r.value.findIndex(u=>u.id===s);n!==-1&&(r.value[n].quantity=e,xe())}}catch(n){console.error("Failed to update item quantity:",n);const u=he(n);y&&y({title:"Update Failed",message:u||"Failed to update item quantity. Please try again.",toastType:"error",duration:3e3})}},Dt=async s=>{if(typeof s=="string")try{if(J){const e=await J(s);e&&e.success?(r.value=r.value.filter(n=>n.id!==s),xe(),y&&y({title:e.title||"Item Removed",message:e.message||"Item has been removed from your cart",toastType:"info",duration:3e3})):e&&!e.success&&y&&y({title:e.title||"Removal Failed",message:e.message||"Failed to remove item from cart. Please try again.",toastType:"error",duration:3e3})}else r.value=r.value.filter(e=>e.id!==s),xe()}catch(e){console.error("Failed to remove item from cart:",e);const n=he(e);y&&y({title:"Removal Failed",message:n||"Failed to remove item from cart. Please try again.",toastType:"error",duration:3e3})}},qt=s=>{const e=s.target;e&&(e.src="/placeholder.svg?height=100&width=100")},it=()=>{const s=ee?ee(L.GUEST_MODE)==="true":!1,e=localStorage?localStorage.getItem("token"):null;!ie.value&&!s&&!e&&(A.value=!0)};return re(r,()=>{xe(),w.value==="installment"&&be()},{deep:!0}),re(b,()=>{be(),Q()},{deep:!0}),re(w,()=>{Q()}),re(ie,s=>{s?(A.value=!1,oe.value&&i.value&&(i.value.firstName=oe.value.firstName||"",i.value.lastName=oe.value.lastName||"",i.value.email=oe.value.email||"",i.value.phone=oe.value.phone||"",Q())):it()}),re(p,s=>{s&&(je(),st())}),re(i,()=>{Q()},{deep:!0}),re(I,()=>{Q()}),re(D,()=>{Q()}),Fe(async()=>{It(),kt(),await Tt(),Mt(),Ee(()=>{it()}),(!r.value||r.value.length===0)&&($.value&&$.value.length>0?(r.value=$.value,xe()):G.push("/artworks")),K.value=$e(),console.log("Mounted - currentInstallmentConfig:",K.value),console.log("Mounted - hasInstallmentOptions:",Ie.value)}),j({cancelCheckout:()=>{st(),je(),G.push("/artworks")}}),(s,e)=>{const n=Lt,u=_s;return c(),f("div",Ss,[e[115]||(e[115]=t("div",{class:"fixed inset-0 opacity-5 pointer-events-none"},[t("div",{class:"absolute inset-0",style:{"background-image":"radial-gradient(circle at 1px 1px, rgba(0,0,0,0.15) 1px, transparent 0)","background-size":"20px 20px"}})],-1)),!r.value||r.value.length===0?(c(),f("div",Ts,[t("div",As,[t("div",Ns,[C(g(Zt),{class:"w-12 h-12 text-slate-400"})]),e[32]||(e[32]=t("h2",{class:"text-2xl font-bold text-slate-800 mb-4"},"Your cart is empty",-1)),e[33]||(e[33]=t("p",{class:"text-slate-600 mb-8"},"Add some amazing products to your cart to continue with checkout.",-1)),C(n,{to:"/artworks",class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"},{default:Ce(()=>[C(g(He),{class:"w-4 h-4 mr-2"}),e[31]||(e[31]=ne(" Browse Products "))]),_:1,__:[31]})])])):g(p)?(c(),f("div",Ms,[t("div",Es,[t("div",Fs,[t("div",$s,[C(g(es),{class:"w-10 h-10 text-emerald-600"})]),e[34]||(e[34]=t("h2",{class:"text-3xl font-bold text-slate-800 mb-4"},"Order Confirmed!",-1)),e[35]||(e[35]=t("p",{class:"text-slate-600 mb-2"},"Thank you for your purchase",-1)),e[36]||(e[36]=t("p",{class:"text-slate-500 text-sm"},"We've sent a confirmation email with your order details",-1))]),t("div",Os,[t("div",js,[e[37]||(e[37]=t("span",{class:"text-slate-600 font-medium"},"Order Number",-1)),t("span",Rs,"#"+d(pe.value||Rt()),1)]),t("div",Ds,[e[38]||(e[38]=t("span",{class:"text-slate-600 font-medium"},"Payment Type",-1)),t("span",qs,d(w.value==="installment"?"Installment Plan":"Full Payment"),1)]),w.value==="installment"?(c(),f("div",Ls,[e[39]||(e[39]=t("span",{class:"text-slate-600 font-medium"},"Down Payment",-1)),t("span",zs,"$"+d(S(k.value.downPayment)),1)])):T("",!0),t("div",Us,[t("span",Vs,d(w.value==="installment"?"Total Order Value":"Total Amount"),1),t("span",Ys,"$"+d(S(te())),1)])]),C(n,{to:"/",class:"w-full py-4 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-medium flex items-center justify-center"},{default:Ce(()=>e[40]||(e[40]=[ne(" Continue Shopping ")])),_:1,__:[40]})])])):(c(),f("div",Hs,[e[102]||(e[102]=t("div",{class:"text-center mt-20 mb-12"},[t("h1",{class:"text-xl lg:text-3xl font-bold text-slate-800 mb-4"},"Secure Checkout"),t("p",{class:"text-slate-600 max-w-2xl mx-auto"},"Complete your purchase securely. Your information is protected with industry-standard encryption.")],-1)),t("div",Bs,[t("div",Gs,[t("div",Js,[t("div",{class:"h-full bg-gradient-to-r from-slate-800 to-slate-900 transition-all duration-500 ease-out",style:Jt({width:`${(h.value-1)/2*100}%`})},null,4)]),t("div",Ws,[t("div",{class:se(["w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 z-10",h.value>=1?"bg-slate-800 text-white shadow-lg":"bg-white border-2 border-slate-200 text-slate-400"])},[C(g(mt),{class:"w-4 h-4"})],2),e[41]||(e[41]=t("span",{class:"text-xs font-medium mt-2 text-slate-600"},"Details",-1))]),t("div",Ks,[t("div",{class:se(["w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 z-10",h.value>=2?"bg-slate-800 text-white shadow-lg":"bg-white border-2 border-slate-200 text-slate-400"])},[C(g(pt),{class:"w-4 h-4"})],2),e[42]||(e[42]=t("span",{class:"text-xs font-medium mt-2 text-slate-600"},"Shipping",-1))]),t("div",Qs,[t("div",{class:se(["w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 z-10",h.value>=3?"bg-slate-800 text-white shadow-lg":"bg-white border-2 border-slate-200 text-slate-400"])},[C(g(Ne),{class:"w-4 h-4"})],2),e[43]||(e[43]=t("span",{class:"text-xs font-medium mt-2 text-slate-600"},"Payment",-1))])])]),t("div",Xs,[t("div",Zs,[C(qe,{name:"slide-fade",mode:"out-in"},{default:Ce(()=>[h.value===1?(c(),f("div",ea,[t("div",ta,[t("div",sa,[C(g(mt),{class:"w-5 h-5 text-slate-600"})]),e[44]||(e[44]=t("h2",{class:"text-xl lg:text-2xl font-bold text-slate-800"},"Customer Details",-1))]),t("form",{onSubmit:Ue(nt,["prevent"]),class:"space-y-6"},[t("div",aa,[t("div",la,[e[45]||(e[45]=t("label",{for:"firstName",class:"block text-sm font-semibold text-slate-700"},"First Name",-1)),F(t("input",{id:"firstName","onUpdate:modelValue":e[0]||(e[0]=l=>i.value.firstName=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter your first name",onInput:de},null,544),[[Y,i.value.firstName]])]),t("div",na,[e[46]||(e[46]=t("label",{for:"lastName",class:"block text-sm font-semibold text-slate-700"},"Last Name",-1)),F(t("input",{id:"lastName","onUpdate:modelValue":e[1]||(e[1]=l=>i.value.lastName=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter your last name",onInput:de},null,544),[[Y,i.value.lastName]])])]),t("div",oa,[e[47]||(e[47]=t("label",{for:"email",class:"block text-sm font-semibold text-slate-700"},"Email Address",-1)),F(t("input",{id:"email","onUpdate:modelValue":e[2]||(e[2]=l=>i.value.email=l),type:"email",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter your email address",onInput:de},null,544),[[Y,i.value.email]])]),t("div",ra,[e[48]||(e[48]=t("label",{for:"phone",class:"block text-sm font-semibold text-slate-700"},"Phone Number",-1)),F(t("input",{id:"phone","onUpdate:modelValue":e[3]||(e[3]=l=>i.value.phone=l),type:"tel",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter your phone number",onInput:de},null,544),[[Y,i.value.phone]])]),t("div",ia,[e[49]||(e[49]=t("label",{for:"address",class:"block text-sm font-semibold text-slate-700"},"Street Address",-1)),F(t("input",{id:"address","onUpdate:modelValue":e[4]||(e[4]=l=>i.value.address=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter your street address",onInput:de},null,544),[[Y,i.value.address]])]),t("div",da,[t("div",ua,[e[50]||(e[50]=t("label",{for:"city",class:"block text-sm font-semibold text-slate-700"},"City",-1)),F(t("input",{id:"city","onUpdate:modelValue":e[5]||(e[5]=l=>i.value.city=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"City",onInput:de},null,544),[[Y,i.value.city]])]),t("div",ca,[e[51]||(e[51]=t("label",{for:"state",class:"block text-sm font-semibold text-slate-700"},"State",-1)),F(t("input",{id:"state","onUpdate:modelValue":e[6]||(e[6]=l=>i.value.state=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"State",onInput:de},null,544),[[Y,i.value.state]])]),t("div",ma,[e[52]||(e[52]=t("label",{for:"zipCode",class:"block text-sm font-semibold text-slate-700"},"ZIP Code",-1)),F(t("input",{id:"zipCode","onUpdate:modelValue":e[7]||(e[7]=l=>i.value.zipCode=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"ZIP",onInput:de},null,544),[[Y,i.value.zipCode]])])]),t("div",pa,[e[54]||(e[54]=t("label",{for:"country",class:"block text-sm font-semibold text-slate-700"},"Country",-1)),F(t("select",{id:"country","onUpdate:modelValue":e[8]||(e[8]=l=>i.value.country=l),required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200 bg-white",onChange:at},[e[53]||(e[53]=t("option",{value:""},"Select Country",-1)),(c(!0),f(Le,null,ze(St.value,l=>(c(),f("option",{key:l.countryCode,value:l.countryCode},d(l.countryName),9,fa))),128))],544),[[Ae,i.value.country]])]),t("button",ga,[e[55]||(e[55]=ne(" Continue to Shipping ")),C(g(ft),{class:"w-5 h-5 ml-2"})])],32)])):h.value===2?(c(),f("div",ya,[t("div",va,[t("div",ba,[C(g(pt),{class:"w-5 h-5 text-slate-600"})]),e[56]||(e[56]=t("h2",{class:"text-xl lg:text-2xl font-bold text-slate-800"},"Shipping Method",-1))]),t("div",xa,[t("div",{class:se(["border-2 rounded-xl p-4 cursor-pointer transition-all duration-300 hover:shadow-md",I.value==="standard"?"border-slate-800 bg-slate-50 shadow-md":"border-slate-200 hover:border-slate-300"]),onClick:e[9]||(e[9]=l=>At("standard"))},[t("div",ha,[t("div",{class:se(["w-6 h-6 rounded-full border-2 mr-4 flex items-center justify-center transition-all duration-200",I.value==="standard"?"border-slate-800 bg-slate-800":"border-slate-300"])},[I.value==="standard"?(c(),f("div",wa)):T("",!0)],2),t("div",_a,[t("div",Ca,[e[57]||(e[57]=t("span",{class:"font-semibold text-slate-800"},"Express Shipping",-1)),t("span",Pa,"$"+d(S(z.value)),1)]),e[58]||(e[58]=t("p",{class:"text-sm text-slate-600"},"Delivery within 5-7 business days",-1))])])],2)]),t("div",Ia,[t("button",{onClick:ot,class:"flex-1 py-3 border-2 text-sm border-slate-300 text-slate-700 rounded-xl hover:bg-slate-50 transition-all duration-300 font-medium flex items-center justify-center"},[C(g(He),{class:"w-4 h-4 mr-2"}),e[59]||(e[59]=ne(" Back "))]),t("button",{onClick:nt,class:"flex-1 py-3 px-3 text-sm bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-medium flex items-center justify-center"},[e[60]||(e[60]=ne(" Continue to Payment ")),C(g(ft),{class:"w-4 h-4 ml-2"})])])])):h.value===3?(c(),f("div",ka,[t("div",Sa,[t("div",Ta,[C(g(Ne),{class:"w-5 h-5 text-slate-600"})]),e[61]||(e[61]=t("h2",{class:"text-lg lg:text-2xl font-bold text-slate-800"},"Payment Options",-1))]),t("div",Aa,[e[67]||(e[67]=t("h3",{class:"text-base lg:text-lg font-semibold text-slate-800 mb-4"},"Choose Payment Type",-1)),t("div",Na,[t("div",{class:se(["border-2 rounded-xl p-4 cursor-pointer transition-all duration-300 hover:shadow-md",w.value==="full"?"border-slate-800 bg-slate-50 shadow-md":"border-slate-200 hover:border-slate-300"]),onClick:e[10]||(e[10]=l=>tt("full"))},[t("div",Ma,[t("div",{class:se(["w-6 h-6 rounded-full border-2 mr-4 flex items-center justify-center transition-all duration-200",w.value==="full"?"border-slate-800 bg-slate-800":"border-slate-300"])},[w.value==="full"?(c(),f("div",Ea)):T("",!0)],2),t("div",Fa,[t("div",$a,[e[62]||(e[62]=t("span",{class:"font-semibold text-slate-800"},"Pay Full Amount",-1)),t("span",Oa,"$"+d(S(te())),1)]),e[63]||(e[63]=t("p",{class:"text-sm text-slate-600"},"Complete payment now with no additional fees",-1))]),t("div",ja,[C(g(Ne),{class:"w-6 h-6 text-emerald-600"})])])],2),Ie.value?(c(),f("div",{key:0,class:se(["border-2 rounded-xl p-4 cursor-pointer transition-all duration-300 hover:shadow-md",w.value==="installment"?"border-slate-800 bg-slate-50 shadow-md":"border-slate-200 hover:border-slate-300"]),onClick:e[11]||(e[11]=l=>tt("installment"))},[t("div",Ra,[t("div",{class:se(["w-6 h-6 rounded-full border-2 mr-4 flex items-center justify-center transition-all duration-200",w.value==="installment"?"border-slate-800 bg-slate-800":"border-slate-300"])},[w.value==="installment"?(c(),f("div",Da)):T("",!0)],2),t("div",qa,[t("div",La,[e[64]||(e[64]=t("span",{class:"font-semibold text-slate-800"},"Installment Plan",-1)),t("span",za,"From $"+d(S(ht()))+"/month",1)]),e[65]||(e[65]=t("p",{class:"text-sm text-slate-600"},"Split your payment into manageable installments",-1))]),t("div",Ua,[C(g(ns),{class:"w-6 h-6 text-blue-600"})])])],2)):T("",!0),Ie.value?T("",!0):(c(),f("div",Va,[t("div",Ya,[C(g(os),{class:"w-5 h-5 text-yellow-600 mr-2"}),e[66]||(e[66]=t("span",{class:"text-sm text-yellow-800"},"No installment options available for current cart items",-1))]),t("div",Ha,[t("p",null,"Cart items with installment options: "+d(xt.value.length),1),t("p",null,"Total cart items: "+d(r.value.length),1)])]))])]),C(qe,{name:"fade"},{default:Ce(()=>[w.value==="installment"?(c(),f("div",Ba,[t("h3",Ga,[C(g(ds),{class:"w-5 h-5 mr-2 text-blue-600"}),e[68]||(e[68]=ne(" Configure Your Installment Plan "))]),t("div",Ja,[t("div",Wa,[t("div",Ka,[e[69]||(e[69]=t("span",{class:"text-sm font-medium text-slate-600"},"Total Amount Agreed",-1)),t("span",Qa,"$"+d(S(te())),1)]),e[70]||(e[70]=t("p",{class:"text-xs text-slate-500"},"This is the total amount you agree to pay including interest",-1))]),t("div",Xa,[e[72]||(e[72]=t("label",{class:"block text-sm font-semibold text-slate-700"}," Preferred number of installments? ",-1)),F(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>b.value.numberOfInstallments=l),onChange:be,class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white",required:""},[e[71]||(e[71]=t("option",{value:""},"Select installment terms",-1)),(c(!0),f(Le,null,ze(Qe.value,l=>(c(),f("option",{key:l,value:l},d(l)+" months (Est. $"+d(S(wt(l)))+"/month) ) ",9,Za))),128))],544),[[Ae,b.value.numberOfInstallments]])]),t("div",el,[e[74]||(e[74]=t("label",{class:"block text-sm font-semibold text-slate-700"}," How often would you like to pay? ",-1)),F(t("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>b.value.paymentFrequency=l),onChange:be,class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white",required:""},e[73]||(e[73]=[t("option",{value:""},"Select payment frequency",-1),t("option",{value:"weekly"},"Weekly",-1),t("option",{value:"biweekly"},"Bi-weekly (Every 2 weeks)",-1),t("option",{value:"monthly"},"Monthly",-1)]),544),[[Ae,b.value.paymentFrequency]])]),t("div",tl,[t("label",sl," Down Payment Amount ("+d(Xe())+"% - "+d(Ze())+"%) ",1),t("div",al,[e[75]||(e[75]=t("span",{class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"},"$",-1)),F(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>b.value.downPayment=l),onInput:be,type:"number",min:_e(),max:ke(),step:"0.01",class:"w-full pl-8 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white",placeholder:"Enter down payment amount",required:""},null,40,ll),[[Y,b.value.downPayment,void 0,{number:!0}]])]),t("div",nl,[t("span",null,"Min: $"+d(S(_e())),1),t("span",null,"Max: $"+d(S(ke())),1)])]),t("div",ol,[e[76]||(e[76]=t("label",{class:"block text-sm font-semibold text-slate-700"}," Start date for the first payment? ",-1)),F(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>b.value.startDate=l),type:"date",min:_t(),class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white",required:""},null,8,rl),[[Y,b.value.startDate]])]),t("div",il,[e[78]||(e[78]=t("label",{class:"block text-sm font-semibold text-slate-700"}," Preferred payment method? ",-1)),F(t("select",{"onUpdate:modelValue":e[16]||(e[16]=l=>b.value.paymentMethod=l),class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 bg-white",required:""},e[77]||(e[77]=[t("option",{value:""},"Select payment method",-1),t("option",{value:"auto_deduction"},"Auto Deduction (Recommended)",-1),t("option",{value:"manual"},"Manual Payment",-1)]),512),[[Ae,b.value.paymentMethod]])]),t("div",dl,[e[81]||(e[81]=t("label",{class:"block text-sm font-semibold text-slate-700"}," Do you need a formal agreement for this plan? ",-1)),t("div",ul,[t("label",cl,[F(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>b.value.needsFormalAgreement=l),type:"radio",value:!0,class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[ct,b.value.needsFormalAgreement]]),e[79]||(e[79]=t("span",{class:"ml-2 text-sm text-slate-700"},"Yes, I need a formal agreement",-1))]),t("label",ml,[F(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>b.value.needsFormalAgreement=l),type:"radio",value:!1,class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[ct,b.value.needsFormalAgreement]]),e[80]||(e[80]=t("span",{class:"ml-2 text-sm text-slate-700"},"No, proceed without formal agreement",-1))])])]),k.value.installmentAmount>0?(c(),f("div",pl,[e[88]||(e[88]=t("h4",{class:"font-semibold text-slate-800 mb-4"},"Installment Plan Summary",-1)),t("div",fl,[t("div",gl,[e[82]||(e[82]=t("span",{class:"text-sm text-slate-600"},"Down Payment (Today)",-1)),t("span",yl,"$"+d(S(k.value.downPayment)),1)]),t("div",vl,[e[83]||(e[83]=t("span",{class:"text-sm text-slate-600"},"Installment Amount",-1)),t("span",bl,"$"+d(S(k.value.installmentAmount)),1)]),t("div",xl,[e[84]||(e[84]=t("span",{class:"text-sm text-slate-600"},"Number of Payments",-1)),t("span",hl,d(b.value.numberOfInstallments),1)]),t("div",wl,[e[85]||(e[85]=t("span",{class:"text-sm text-slate-600"},"Interest Rate",-1)),t("span",_l,d(et())+"% annually",1)]),t("div",Cl,[e[86]||(e[86]=t("span",{class:"text-sm text-slate-600"},"Total Interest",-1)),t("span",Pl,"$"+d(S(k.value.totalInterest)),1)]),t("div",Il,[t("div",kl,[e[87]||(e[87]=t("span",{class:"font-semibold text-slate-800"},"Total Payable",-1)),t("span",Sl,"$"+d(S(k.value.totalPayable)),1)])])])])):T("",!0)])])):T("",!0)]),_:1}),t("div",Tl,[e[90]||(e[90]=t("h3",{class:"text-lg font-semibold text-slate-800 mb-4"},"Payment Gateway",-1)),t("div",Al,[t("div",{class:se(["border-2 rounded-xl p-4 cursor-pointer transition-all duration-300 hover:shadow-md",D.value==="flutterwave"?"border-slate-800 bg-slate-50 shadow-md":"border-slate-200 hover:border-slate-300"]),onClick:e[19]||(e[19]=l=>Nt("flutterwave"))},[t("div",Nl,[t("div",{class:se(["w-6 h-6 rounded-full border-2 mr-4 flex items-center justify-center transition-all duration-200",D.value==="flutterwave"?"border-slate-800 bg-slate-800":"border-slate-300"])},[D.value==="flutterwave"?(c(),f("div",Ml)):T("",!0)],2),e[89]||(e[89]=t("div",{class:"flex-1"},[t("span",{class:"font-semibold text-slate-800"},"Pay with Card"),t("p",{class:"text-sm text-slate-600"},"Secure payment via Flutterwave")],-1)),t("div",El,[C(g(Ne),{class:"w-6 h-6 text-slate-600"})])])],2)])]),t("div",Fl,[t("button",{onClick:ot,class:"flex-1 py-3 border-2 w-full border-slate-300 text-slate-700 rounded-xl hover:bg-slate-50 transition-all duration-300 font-medium flex items-center justify-center"},[C(g(He),{class:"w-4 h-4 mr-2"}),e[91]||(e[91]=ne(" Back "))]),t("button",{onClick:Et,disabled:g(_)||!Ct.value,class:"flex-1 py-3 w-full bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-xl hover:from-emerald-700 hover:to-emerald-800 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl font-medium flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"},[g(_)?(c(),Ve(g(Ye),{key:0,class:"w-5 h-5 mr-2 animate-spin"})):T("",!0),ne(" "+d(Pt()),1)],8,$l)])])):T("",!0)]),_:1})]),t("div",Ol,[t("div",jl,[t("div",Rl,[t("div",Dl,[C(g(us),{class:"w-5 h-5 text-slate-600"})]),e[92]||(e[92]=t("h2",{class:"text-lg lg:text-xl font-bold text-slate-800"},"Order Summary",-1))]),r.value&&r.value.length>0?(c(),f("div",ql,[(c(!0),f(Le,null,ze(r.value,l=>(c(),f("div",{key:l.id,class:"flex gap-4 p-4 border border-slate-100 rounded-xl hover:bg-slate-50 transition-all duration-200 group"},[t("div",Ll,[t("img",{src:l.image||"/placeholder.svg?height=64&width=64",alt:l.title,class:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110",onError:qt},null,40,zl)]),t("div",Ul,[t("h4",Vl,d(l.title),1),t("p",Yl,"$"+d(S(l.price)),1),t("div",Hl,[l.size?(c(),f("span",Bl,d(l.size),1)):T("",!0),l.color?(c(),f("span",Gl,d(l.color),1)):T("",!0),l.hasInstallmentOption?(c(),f("span",Jl,"💳 Installments")):T("",!0)]),t("div",Wl,[t("button",{onClick:B=>rt(l.id,Math.max(1,l.quantity-1)),class:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center hover:bg-slate-100 transition-colors",disabled:l.quantity<=1},[C(g(rs),{class:"w-3 h-3"})],8,Kl),t("span",Ql,d(l.quantity),1),t("button",{onClick:B=>rt(l.id,l.quantity+1),class:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center hover:bg-slate-100 transition-colors"},[C(g(is),{class:"w-3 h-3"})],8,Xl),t("button",{onClick:B=>Dt(l.id),class:"ml-auto w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors"},[C(g(cs),{class:"w-3 h-3"})],8,Zl)])]),t("div",en,[t("span",tn,"$"+d(S(l.price*l.quantity)),1)])]))),128))])):T("",!0),t("div",sn,[t("div",an,[e[93]||(e[93]=t("span",{class:"text-slate-600"},"Subtotal",-1)),t("span",ln,"$"+d(S(Se.value)),1)]),t("div",nn,[e[94]||(e[94]=t("span",{class:"text-slate-600"},"Shipping",-1)),t("span",on,d(Te()===0?"Free":`$${S(Te())}`),1)]),t("div",rn,[t("span",dn,"Tax ("+d(R.value)+"%)",1),t("span",un,"$"+d(S(Oe())),1)]),w.value==="installment"&&k.value.installmentAmount>0?(c(),f("div",cn,[e[97]||(e[97]=t("div",{class:"text-xs font-semibold text-blue-800 mb-2"},"Installment Plan",-1)),t("div",mn,[e[95]||(e[95]=t("span",null,"Down Payment",-1)),t("span",null,"$"+d(S(k.value.downPayment)),1)]),t("div",pn,[t("span",null,d(b.value.numberOfInstallments)+" × $"+d(S(k.value.installmentAmount)),1),t("span",null,"$"+d(S(k.value.installmentAmount*b.value.numberOfInstallments)),1)]),t("div",fn,[e[96]||(e[96]=t("span",null,"Total Interest",-1)),t("span",null,"$"+d(S(k.value.totalInterest)),1)])])):T("",!0),P.value?(c(),f("div",gn,[t("p",null,"Shipping to: "+d(P.value.countryName),1),t("p",null,"Tax Rate: "+d(R.value)+"%",1),w.value==="installment"?(c(),f("p",yn,"Payment Type: Installment Plan")):T("",!0)])):T("",!0),t("div",vn,[t("span",bn,d(w.value==="installment"?"Total Payable":"Total"),1),t("span",xn," $"+d(S(w.value==="installment"&&k.value.totalPayable>0?k.value.totalPayable:te())),1)]),w.value==="installment"&&k.value.downPayment>0?(c(),f("div",hn,[t("div",wn,[e[98]||(e[98]=t("span",null,"Today's Payment",-1)),t("span",null,"$"+d(S(k.value.downPayment)),1)]),e[99]||(e[99]=t("p",{class:"text-xs text-emerald-600 mt-1"},"Down payment due now",-1))])):T("",!0)]),t("div",_n,[t("div",Cn,[C(g(ts),{class:"w-4 h-4 mr-2"}),e[100]||(e[100]=t("span",null,"Secure 256-bit SSL encryption",-1))]),e[101]||(e[101]=Je('<div class="flex gap-2" data-v-fe0c3afe><div class="w-10 h-6 bg-slate-100 rounded flex items-center justify-center" data-v-fe0c3afe><span class="text-xs font-bold text-slate-600" data-v-fe0c3afe>VISA</span></div><div class="w-10 h-6 bg-slate-100 rounded flex items-center justify-center" data-v-fe0c3afe><span class="text-xs font-bold text-slate-600" data-v-fe0c3afe>MC</span></div><div class="w-10 h-6 bg-slate-100 rounded flex items-center justify-center" data-v-fe0c3afe><span class="text-xs font-bold text-slate-600" data-v-fe0c3afe>AMEX</span></div></div>',1))])])])])])),C(qe,{name:"modal"},{default:Ce(()=>[A.value?(c(),f("div",Pn,[t("div",In,[t("button",{onClick:$t,class:"absolute top-4 right-4 w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center hover:bg-slate-200 transition-colors"},[C(g(ms),{class:"w-4 h-4"})]),U.value==="check"?(c(),f("div",kn,[e[103]||(e[103]=t("h2",{class:"text-2xl font-bold text-center text-slate-800 mb-4"},"Welcome!",-1)),e[104]||(e[104]=t("p",{class:"text-slate-600 text-center mb-6"},"Sign in to track your orders and save your preferences, or continue as a guest.",-1)),t("div",Sn,[t("button",{onClick:e[20]||(e[20]=l=>U.value="signin"),class:"w-full py-3 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 font-medium"}," Sign In "),t("button",{onClick:e[21]||(e[21]=l=>U.value="signup"),class:"w-full py-3 border-2 border-slate-300 text-slate-700 rounded-xl hover:bg-slate-50 transition-all duration-300 font-medium"}," Create Account "),t("button",{onClick:Ft,class:"w-full py-3 text-slate-600 hover:text-slate-800 transition-colors font-medium"}," Continue as Guest ")])])):U.value==="signin"?(c(),f("div",Tn,[e[107]||(e[107]=t("h2",{class:"text-2xl font-bold text-center text-slate-800 mb-6"},"Sign In",-1)),t("div",An,[C(u,{onCallback:V,authType:"login"})]),t("form",{onSubmit:Ue(jt,["prevent"]),class:"space-y-4"},[t("div",Nn,[e[105]||(e[105]=t("label",{for:"signinEmail",class:"block text-sm font-semibold text-slate-700"},"Email",-1)),F(t("input",{id:"signinEmail","onUpdate:modelValue":e[22]||(e[22]=l=>ve.value.email=l),type:"email",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your email"},null,512),[[Y,ve.value.email]])]),t("div",Mn,[e[106]||(e[106]=t("label",{for:"signinPassword",class:"block text-sm font-semibold text-slate-700"},"Password",-1)),F(t("input",{id:"signinPassword","onUpdate:modelValue":e[23]||(e[23]=l=>ve.value.password=l),type:"password",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your password"},null,512),[[Y,ve.value.password]])]),t("button",{type:"submit",disabled:H.value,class:"w-full py-3 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 font-medium flex items-center justify-center disabled:opacity-50"},[H.value?(c(),Ve(g(Ye),{key:0,class:"w-5 h-5 mr-2 animate-spin"})):T("",!0),ne(" "+d(H.value?"Signing In...":"Sign In"),1)],8,En),t("div",Fn,[t("button",{type:"button",onClick:e[24]||(e[24]=l=>U.value="signup"),class:"text-slate-600 hover:text-slate-800 font-medium"}," Don't have an account? Sign up ")])],32)])):U.value==="signup"?(c(),f("div",$n,[e[114]||(e[114]=t("h2",{class:"text-2xl text-center font-bold text-slate-800 mb-6"},"Create Account",-1)),t("div",On,[C(u,{onCallback:V,authType:"signup"})]),t("form",{onSubmit:Ue(Ot,["prevent"]),class:"space-y-4"},[t("div",jn,[t("div",Rn,[e[108]||(e[108]=t("label",{for:"firstName",class:"block text-sm font-semibold text-slate-700"},"First Name",-1)),F(t("input",{id:"firstName","onUpdate:modelValue":e[25]||(e[25]=l=>q.value.firstName=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"First name"},null,512),[[Y,q.value.firstName]])]),t("div",Dn,[e[109]||(e[109]=t("label",{for:"lastName",class:"block text-sm font-semibold text-slate-700"},"Last Name",-1)),F(t("input",{id:"lastName","onUpdate:modelValue":e[26]||(e[26]=l=>q.value.lastName=l),type:"text",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Last name"},null,512),[[Y,q.value.lastName]])])]),t("div",qn,[e[110]||(e[110]=t("label",{for:"signupEmail",class:"block text-sm font-semibold text-slate-700"},"Email",-1)),F(t("input",{id:"signupEmail","onUpdate:modelValue":e[27]||(e[27]=l=>q.value.email=l),type:"email",required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your email"},null,512),[[Y,q.value.email]])]),t("div",Ln,[e[111]||(e[111]=t("label",{for:"signupPassword",class:"block text-sm font-semibold text-slate-700"},"Password",-1)),F(t("input",{id:"signupPassword","onUpdate:modelValue":e[28]||(e[28]=l=>q.value.password=l),type:"password",required:"",minlength:"6",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Create a password"},null,512),[[Y,q.value.password]]),e[112]||(e[112]=t("p",{class:"text-xs text-slate-500"},"Password must be at least 6 characters",-1))]),t("div",zn,[e[113]||(e[113]=t("label",{for:"phone",class:"block text-sm font-semibold text-slate-700"},"Phone (Optional)",-1)),F(t("input",{id:"phone","onUpdate:modelValue":e[29]||(e[29]=l=>q.value.phone=l),type:"tel",class:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all duration-200",placeholder:"Enter your phone number"},null,512),[[Y,q.value.phone]])]),t("button",{type:"submit",disabled:W.value,class:"w-full py-3 bg-gradient-to-r from-slate-800 to-slate-900 text-white rounded-xl hover:from-slate-900 hover:to-black transition-all duration-300 font-medium flex items-center justify-center disabled:opacity-50"},[W.value?(c(),Ve(g(Ye),{key:0,class:"w-5 h-5 mr-2 animate-spin"})):T("",!0),ne(" "+d(W.value?"Creating Account...":"Create Account"),1)],8,Un),t("div",Vn,[t("button",{type:"button",onClick:e[30]||(e[30]=l=>U.value="signin"),class:"text-slate-600 hover:text-slate-800 font-medium"}," Already have an account? Sign in ")])],32)])):T("",!0)])])):T("",!0)]),_:1})])}}}),Xn=Kt(Hn,[["__scopeId","data-v-fe0c3afe"]]);export{Xn as default};
